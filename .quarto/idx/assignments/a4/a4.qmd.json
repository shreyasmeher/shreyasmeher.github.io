{"title":"Assignment 4","markdown":{"yaml":{"title":"Assignment 4","author":"Shreyas Meher","format":"html"},"headingText":"Introduction","containsRefs":false,"markdown":"\n\n\nForeign aid and migration are two closely intertwined topics that have gained significant attention in recent years. Foreign aid refers to the financial or material assistance provided by one country to another, typically with the aim of promoting economic, social, or political development in the recipient country. Migration, on the other hand, refers to the movement of people from one country to another, usually in search of better economic opportunities, political stability, or refuge from conflict or persecution.\n\nForeign aid can have both positive and negative effects on migration. On the one hand, aid can help to reduce poverty and create economic opportunities in recipient countries, which may discourage people from emigrating in search of better prospects. On the other hand, aid can also contribute to the creation of a dependent relationship between donor and recipient countries, which may perpetuate economic and political instability and ultimately drive people to migrate.\n\nMoreover, the impact of migration on recipient countries can also vary depending on the context. While migration can bring new skills, ideas, and resources to host countries, it can also pose challenges in terms of social integration, labor market competition, and cultural differences.\n\nOverall, the relationship between foreign aid and migration is complex and multifaceted, and requires careful consideration and analysis to understand its implications and potential solutions.\n\n## Data\n\nThe World Development Indicators (WDI) package in R is a tool used to access and manipulate data from the World Bank's World Development Indicators database. The package provides functions for downloading and extracting data on a wide range of indicators related to economic and social development, such as population, GDP, education, health, and poverty.\n\nThe WDI package in R allows users to easily retrieve data from the World Bank database in a format that is suitable for analysis and visualization. The package includes functions for filtering and aggregating data, as well as for merging data from multiple indicators and countries.\n\n```{r}\n#| echo: false\n\npacman::p_load(ggplot2, dplyr, WDI, animation, ggdendro, stats,mice, factoextra)\n\nmigration<-WDI(country = \"ET\", indicator = \"SM.POP.NETM\", \n               start = 1970, end = 2020)\nmigration=subset(migration, select = c(country, year, SM.POP.NETM))\n\naid<-WDI(country = \"ET\",indicator = \"DT.ODA.ODAT.CD\",\n         start = 1970, end = 2020)\naid=subset(aid, select = c(country, year, DT.ODA.ODAT.CD))\n\ninflation<-WDI(country = \"ET\",indicator = \"FP.CPI.TOTL.ZG\",\n         start = 1970, end = 2020)\ninflation=subset(inflation, select = c(country, year, FP.CPI.TOTL.ZG))\n\ndf <- merge(migration, aid, by=c(\"country\",\"year\"), all=TRUE)\ndf <-merge(df, inflation, by=c(\"country\",\"year\"), all=TRUE)\ncolnames(df)<-c(\"country\",\"year\",\"migr\",\"fa\",\"inf\")\nnames(df)\n\n\n```\n\n## Scaling all of the data \n\nScaling data before applying the k-means clustering algorithm is important because it helps to ensure that variables with larger scales or variances do not dominate the analysis.\n\nK-means clustering is a distance-based clustering algorithm, which means that it uses the Euclidean distance between variables to form clusters. If variables have different scales, those with larger scales or variances will have a greater impact on the distance calculation, and thus, the clustering outcome.\n\nBy scaling the data, we can ensure that each variable has a similar range of values and variance, which allows the k-means algorithm to equally weigh each variable in the clustering process. This can improve the accuracy and robustness of the clustering results.\n\nAdditionally, scaling the data can also help to improve the interpretability of the results. Since the variables are on the same scale, it is easier to compare the contributions of each variable to the cluster formation and to understand the relative importance of each variable in differentiating between the clusters.\n\n```{r}\n#| echo: false\nrescaled_comp <- df[3:5] %>%\n  mutate(mig_scale = scale(migr),\n         fa_scale = scale(fa), \n        inf_scale = scale(inf)) %>%\n  select(c(mig_scale, fa_scale, inf_scale))\n\nggplot(data = rescaled_comp, aes(x = mig_scale, y = fa_scale, size = inf_scale)) +\n  geom_point(pch = 20, col = \"blue\") +\n  scale_size_continuous(name = \"Inflation, consumer prices (annual %)\", range = c(2, 8)) +\n  theme_bw() +\n  labs(x = \"Net Migration\", y =\"Net official development assistance received (current US$)\")\n```\n\n## Animated clusterplot\n\n![](https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExMGMwZjdlMDQzMTdjMWViMzVjZTA0ZTY2MTkxZWM4NzE2MGQ3N2YwNCZjdD1n/lhXBuebTF2qazw8Ima/giphy.gif)\n\n```{r}\n#| echo: false\n\n#set.seed(2345)\n#kmeans.ani(rescaled_comp[1:3], centers = 4, pch = 15:18, col = 1:4) \n\n```\n\n## Hierarchical Clustering\n\n```{r}\n#| echo: false\n\n# Compute hierarchical clustering\nhc <- hclust(dist(rescaled_comp), method = \"ward.D2\")\n\n# Create a vector of labels with the year variable\nlabels <- paste0(\"Year: \", df$year)\n\n# Plot dendrogram with labels\nplot(hc, main = \"Dendrogram of Clustered Data\", xlab = \"Observation Index\", labels = labels)\n\n```\n\n\n## Clustering plots & figuring out optimum cluster number\n\n```{r}\n#| echo: false\n\n## Create cluster using k-means, k = 3, with 25 initial configurations\nfa_cluster <- kmeans(rescaled_comp, centers = 3,\n                       iter.max = 10,\n                       nstart = 25)\n\nfa_cluster\n\n# Create a function to compute and plot total within-cluster sum of square (within-ness)\nwssplot <- function(data, nc=15, seed=1234){\n  wss <- (nrow(data)-1)*sum(apply(data,2,var))\n  for (i in 2:nc){\n    set.seed(seed)\n    wss[i] <- sum(kmeans(data, centers=i)$withinss)}\n  plot(1:nc, wss, type=\"b\", xlab=\"Number of Clusters\",\n       ylab=\"Within groups sum of squares\")\n}\n\n# plotting values for each cluster starting from 1 to 9\nwssplot(rescaled_comp, nc = 9)\n\n```\n\n### Further plots\n\n```{r}\n#| echo: false\n# Plot results by dimensions\nfa_cluster$cluster = as.factor(fa_cluster$cluster)\npairs(df[3:5],\n      col = c(\"firebrick1\", \"darkblue\", \"forestgreen\")[fa_cluster$cluster],\n      pch = c(15:17)[fa_cluster$cluster],\n      main = \"K-Means Clusters: FA data\")\n\ntable(fa_cluster$cluster)\n\nget_cluster_wss <- function(data, clusters, method = \"wss\") {\n  wss_values <- c()\n  \n  for(i in clusters) {\n    model <- kmeans(data, centers = i)\n    if(method == \"wss\") {\n      wss_values <- c(wss_values, sum(model$withinss))\n    } else {\n      wss_values <- c(wss_values, silhouette(model$cluster, dist(data))[[\"avg.width\"]])\n    }\n  }\n  \n  return(wss_values)\n}\n\nfa.km <- eclust(rescaled_comp, \"kmeans\", k = 3, nboot = 2)\n\n\nfviz_silhouette(fa.km)\n\n\n```\n","srcMarkdownNoYaml":"\n\n## Introduction\n\nForeign aid and migration are two closely intertwined topics that have gained significant attention in recent years. Foreign aid refers to the financial or material assistance provided by one country to another, typically with the aim of promoting economic, social, or political development in the recipient country. Migration, on the other hand, refers to the movement of people from one country to another, usually in search of better economic opportunities, political stability, or refuge from conflict or persecution.\n\nForeign aid can have both positive and negative effects on migration. On the one hand, aid can help to reduce poverty and create economic opportunities in recipient countries, which may discourage people from emigrating in search of better prospects. On the other hand, aid can also contribute to the creation of a dependent relationship between donor and recipient countries, which may perpetuate economic and political instability and ultimately drive people to migrate.\n\nMoreover, the impact of migration on recipient countries can also vary depending on the context. While migration can bring new skills, ideas, and resources to host countries, it can also pose challenges in terms of social integration, labor market competition, and cultural differences.\n\nOverall, the relationship between foreign aid and migration is complex and multifaceted, and requires careful consideration and analysis to understand its implications and potential solutions.\n\n## Data\n\nThe World Development Indicators (WDI) package in R is a tool used to access and manipulate data from the World Bank's World Development Indicators database. The package provides functions for downloading and extracting data on a wide range of indicators related to economic and social development, such as population, GDP, education, health, and poverty.\n\nThe WDI package in R allows users to easily retrieve data from the World Bank database in a format that is suitable for analysis and visualization. The package includes functions for filtering and aggregating data, as well as for merging data from multiple indicators and countries.\n\n```{r}\n#| echo: false\n\npacman::p_load(ggplot2, dplyr, WDI, animation, ggdendro, stats,mice, factoextra)\n\nmigration<-WDI(country = \"ET\", indicator = \"SM.POP.NETM\", \n               start = 1970, end = 2020)\nmigration=subset(migration, select = c(country, year, SM.POP.NETM))\n\naid<-WDI(country = \"ET\",indicator = \"DT.ODA.ODAT.CD\",\n         start = 1970, end = 2020)\naid=subset(aid, select = c(country, year, DT.ODA.ODAT.CD))\n\ninflation<-WDI(country = \"ET\",indicator = \"FP.CPI.TOTL.ZG\",\n         start = 1970, end = 2020)\ninflation=subset(inflation, select = c(country, year, FP.CPI.TOTL.ZG))\n\ndf <- merge(migration, aid, by=c(\"country\",\"year\"), all=TRUE)\ndf <-merge(df, inflation, by=c(\"country\",\"year\"), all=TRUE)\ncolnames(df)<-c(\"country\",\"year\",\"migr\",\"fa\",\"inf\")\nnames(df)\n\n\n```\n\n## Scaling all of the data \n\nScaling data before applying the k-means clustering algorithm is important because it helps to ensure that variables with larger scales or variances do not dominate the analysis.\n\nK-means clustering is a distance-based clustering algorithm, which means that it uses the Euclidean distance between variables to form clusters. If variables have different scales, those with larger scales or variances will have a greater impact on the distance calculation, and thus, the clustering outcome.\n\nBy scaling the data, we can ensure that each variable has a similar range of values and variance, which allows the k-means algorithm to equally weigh each variable in the clustering process. This can improve the accuracy and robustness of the clustering results.\n\nAdditionally, scaling the data can also help to improve the interpretability of the results. Since the variables are on the same scale, it is easier to compare the contributions of each variable to the cluster formation and to understand the relative importance of each variable in differentiating between the clusters.\n\n```{r}\n#| echo: false\nrescaled_comp <- df[3:5] %>%\n  mutate(mig_scale = scale(migr),\n         fa_scale = scale(fa), \n        inf_scale = scale(inf)) %>%\n  select(c(mig_scale, fa_scale, inf_scale))\n\nggplot(data = rescaled_comp, aes(x = mig_scale, y = fa_scale, size = inf_scale)) +\n  geom_point(pch = 20, col = \"blue\") +\n  scale_size_continuous(name = \"Inflation, consumer prices (annual %)\", range = c(2, 8)) +\n  theme_bw() +\n  labs(x = \"Net Migration\", y =\"Net official development assistance received (current US$)\")\n```\n\n## Animated clusterplot\n\n![](https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExMGMwZjdlMDQzMTdjMWViMzVjZTA0ZTY2MTkxZWM4NzE2MGQ3N2YwNCZjdD1n/lhXBuebTF2qazw8Ima/giphy.gif)\n\n```{r}\n#| echo: false\n\n#set.seed(2345)\n#kmeans.ani(rescaled_comp[1:3], centers = 4, pch = 15:18, col = 1:4) \n\n```\n\n## Hierarchical Clustering\n\n```{r}\n#| echo: false\n\n# Compute hierarchical clustering\nhc <- hclust(dist(rescaled_comp), method = \"ward.D2\")\n\n# Create a vector of labels with the year variable\nlabels <- paste0(\"Year: \", df$year)\n\n# Plot dendrogram with labels\nplot(hc, main = \"Dendrogram of Clustered Data\", xlab = \"Observation Index\", labels = labels)\n\n```\n\n\n## Clustering plots & figuring out optimum cluster number\n\n```{r}\n#| echo: false\n\n## Create cluster using k-means, k = 3, with 25 initial configurations\nfa_cluster <- kmeans(rescaled_comp, centers = 3,\n                       iter.max = 10,\n                       nstart = 25)\n\nfa_cluster\n\n# Create a function to compute and plot total within-cluster sum of square (within-ness)\nwssplot <- function(data, nc=15, seed=1234){\n  wss <- (nrow(data)-1)*sum(apply(data,2,var))\n  for (i in 2:nc){\n    set.seed(seed)\n    wss[i] <- sum(kmeans(data, centers=i)$withinss)}\n  plot(1:nc, wss, type=\"b\", xlab=\"Number of Clusters\",\n       ylab=\"Within groups sum of squares\")\n}\n\n# plotting values for each cluster starting from 1 to 9\nwssplot(rescaled_comp, nc = 9)\n\n```\n\n### Further plots\n\n```{r}\n#| echo: false\n# Plot results by dimensions\nfa_cluster$cluster = as.factor(fa_cluster$cluster)\npairs(df[3:5],\n      col = c(\"firebrick1\", \"darkblue\", \"forestgreen\")[fa_cluster$cluster],\n      pch = c(15:17)[fa_cluster$cluster],\n      main = \"K-Means Clusters: FA data\")\n\ntable(fa_cluster$cluster)\n\nget_cluster_wss <- function(data, clusters, method = \"wss\") {\n  wss_values <- c()\n  \n  for(i in clusters) {\n    model <- kmeans(data, centers = i)\n    if(method == \"wss\") {\n      wss_values <- c(wss_values, sum(model$withinss))\n    } else {\n      wss_values <- c(wss_values, silhouette(model$cluster, dist(data))[[\"avg.width\"]])\n    }\n  }\n  \n  return(wss_values)\n}\n\nfa.km <- eclust(rescaled_comp, \"kmeans\", k = 3, nboot = 2)\n\n\nfviz_silhouette(fa.km)\n\n\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"a4.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.433","theme":{"light":["flatly","../../mystyles.scss"],"dark":["darkly","../../custom-dark.scss"]},"title":"Assignment 4","author":"Shreyas Meher"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}